<div class="container p-8 mx-auto">

  @if (isLoading) {
    <div class="flex justify-center items-center p-16">
      <span class="loading loading-spinner loading-lg text-primary"></span>
    </div>
  } @else {
    @if (business) {
      <h1 class="text-4xl font-bold">{{ business.name }}</h1>
      <p class="text-lg text-base-content/70 mt-2">{{ business.city }}</p>
      <p class="mt-4">{{ business.description }}</p>

      <div class="divider my-8">Nasze Usługi</div>
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
        @for (service of business.services; track service.id) {
          <div class="card bg-base-100 shadow-lg">
            <div class="card-body">
              <h2 class="card-title">{{ service.name }}</h2>
              <p>Czas trwania: {{ service.durationMinutes }} min</p>
              <p class="text-lg font-semibold">{{ service.price }} zł</p>
              <div class="card-actions justify-end">
                @if ((authService.currentUser$ | async); as user) {
                  @if (user.roles.includes('customer')) {
                    <button class="btn btn-primary" (click)="openReservationModal(service, reservation_modal)">Zarezerwuj</button>
                  }
                }
              </div>
            </div>
          </div>
        } @empty {
          <p class="col-span-full">Ta firma nie oferuje jeszcze żadnych usług.</p>
        }
      </div>

      <div class="divider my-8">Nasz Zespół</div>
      <div class="flex flex-wrap gap-4">
        @for (employee of business.employees; track employee.id) {
          <div class="badge badge-lg badge-outline p-4">
            {{ employee.firstName }} {{ employee.lastName }} ({{ employee.position }})
          </div>
        } @empty {
          <p>Brak informacji o pracownikach.</p>
        }
      </div>

    } @else {
      <div class="text-center p-8">
        <h2 class="text-2xl font-bold text-error">Wystąpił błąd</h2>
        <p>Nie udało się załadować danych firmy lub firma o podanym ID nie istnieje.</p>
      </div>
    }
  }

</div>

<app-reservation-modal #reservation_modal [service]="selectedService" [employees]="filteredEmployees"></app-reservation-modal>