<div class="max-w-7xl mx-auto space-y-8 animate-fade-in">
    
    <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4">
        <div>
            <h2 class="text-3xl font-bold text-base-content font-display tracking-tight">Plany Subskrypcyjne</h2>
            <p class="text-base-content/70 mt-1 text-lg">Zarządzaj ofertą cenową i limitami dla firm.</p>
        </div>
    </div>

    <div class="card bg-base-100 shadow-xl border border-base-200">
        <div class="card-body p-6 md:p-8">
            <div class="flex items-center justify-between mb-6 border-b border-base-200 pb-4">
                <h3 class="text-xl font-bold text-base-content flex items-center gap-3">
                    <div class="w-2 h-8 bg-primary rounded-full"></div>
                    {{ isEditing ? 'Edytuj Plan' : 'Dodaj Nowy Plan' }}
                </h3>
                <span *ngIf="isEditing" class="badge badge-primary badge-outline font-mono">
                    Tryb edycji: {{ newPlan.name }}
                </span>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                
                <div class="lg:col-span-2 form-control">
                    <label class="label">
                        <span class="label-text font-bold text-base-content/70 uppercase text-xs tracking-wider">Nazwa Planu</span>
                    </label>
                    <input [(ngModel)]="newPlan.name" type="text" 
                        class="input input-bordered w-full focus:input-primary font-medium" 
                        placeholder="np. Gold Premium">
                </div>
                
                <div class="form-control">
                    <label class="label">
                        <span class="label-text font-bold text-base-content/70 uppercase text-xs tracking-wider">Status</span>
                    </label>
                    <select [(ngModel)]="newPlan.isActive" class="select select-bordered w-full focus:select-primary">
                        <option [ngValue]="true">Aktywny</option>
                        <option [ngValue]="false">Nieaktywny</option>
                    </select>
                </div>

                <div class="hidden lg:block"></div>

                <div class="form-control">
                    <label class="label">
                        <span class="label-text font-bold text-base-content/70 uppercase text-xs tracking-wider">Cena (Msc)</span>
                    </label>
                    <div class="relative">
                        <input [(ngModel)]="newPlan.priceMonthly" type="number" class="input input-bordered w-full pr-12 font-mono font-bold text-lg">
                        <span class="absolute right-4 top-3 text-base-content/50 font-medium">PLN</span>
                    </div>
                </div>
                <div class="form-control">
                    <label class="label">
                        <span class="label-text font-bold text-base-content/70 uppercase text-xs tracking-wider">Cena (Rok)</span>
                    </label>
                    <div class="relative">
                        <input [(ngModel)]="newPlan.priceYearly" type="number" class="input input-bordered w-full pr-12 font-mono font-bold text-lg">
                        <span class="absolute right-4 top-3 text-base-content/50 font-medium">PLN</span>
                    </div>
                </div>
                <div class="form-control">
                    <label class="label">
                        <span class="label-text font-bold text-base-content/70 uppercase text-xs tracking-wider">Prowizja</span>
                    </label>
                    <div class="relative">
                        <input [(ngModel)]="newPlan.commissionPercentage" type="number" step="0.1" class="input input-bordered w-full pr-12 font-mono font-bold text-lg">
                        <span class="absolute right-4 top-3 text-base-content/50 font-medium">%</span>
                    </div>
                </div>
                
                <div class="hidden lg:block"></div>

                <div class="form-control">
                    <label class="label">
                        <span class="label-text font-bold text-base-content/70 uppercase text-xs tracking-wider">Max Pracowników</span>
                    </label>
                    <input [(ngModel)]="newPlan.maxEmployees" type="number" class="input input-bordered w-full text-center font-bold">
                </div>
                <div class="form-control">
                    <label class="label">
                        <span class="label-text font-bold text-base-content/70 uppercase text-xs tracking-wider">Max Usług</span>
                    </label>
                    <input [(ngModel)]="newPlan.maxServices" type="number" class="input input-bordered w-full text-center font-bold">
                </div>

                <div class="lg:col-span-2 flex flex-col sm:flex-row gap-4 mt-2">
                    <div class="form-control flex-1 p-3 border border-base-200 rounded-xl hover:border-primary/50 transition-colors cursor-pointer bg-base-100">
                        <label class="cursor-pointer flex items-center justify-between gap-4">
                            <div>
                                <span class="label-text font-bold block">Raporty Zaawansowane</span>
                                <span class="label-text-alt text-base-content/60">Statystyki finansowe</span>
                            </div>
                            <input [(ngModel)]="newPlan.hasAdvancedReports" type="checkbox" class="toggle toggle-success" />
                        </label>
                    </div>

                    <div class="form-control flex-1 p-3 border border-base-200 rounded-xl hover:border-primary/50 transition-colors cursor-pointer bg-base-100">
                        <label class="cursor-pointer flex items-center justify-between gap-4">
                            <div>
                                <span class="label-text font-bold block">Marketing</span>
                                <span class="label-text-alt text-base-content/60">Narzędzia promocji</span>
                            </div>
                            <input [(ngModel)]="newPlan.hasMarketingTools" type="checkbox" class="toggle toggle-success" />
                        </label>
                    </div>
                </div>
            </div>

            <div class="card-actions justify-end mt-8 pt-6 border-t border-base-200">
                <button *ngIf="isEditing" (click)="cancelEdit()" class="btn btn-ghost">
                    Anuluj
                </button>

                <button (click)="createPlan()" [disabled]="isCreating || !newPlan.name" class="btn btn-primary min-w-[150px]">
                    <span *ngIf="!isCreating" class="flex items-center gap-2">
                        <svg *ngIf="!isEditing" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" /></svg>
                        <svg *ngIf="isEditing" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-5 h-5"><path stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5" /></svg>
                        {{ isEditing ? 'Zapisz Zmiany' : 'Utwórz Plan' }}
                    </span>
                    <span *ngIf="isCreating" class="loading loading-spinner loading-sm"></span>
                </button>
            </div>
        </div>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
        <div *ngFor="let plan of plans" 
             class="card bg-base-100 shadow-lg hover:shadow-2xl transition-all duration-300 border border-base-200 group overflow-hidden">
            
            <div class="h-1.5 w-full bg-gradient-to-r from-primary to-secondary"></div>

            <div class="card-body p-6">
                <div class="flex justify-between items-start mb-4">
                    <div>
                        <h3 class="card-title text-xl font-bold">{{ plan.name }}</h3>
                        <div class="badge badge-sm mt-1 gap-1" [ngClass]="plan.isActive ? 'badge-success badge-outline' : 'badge-ghost'">
                            {{ plan.isActive ? 'Aktywny' : 'Ukryty' }}
                        </div>
                    </div>
                    <div class="text-right">
                        <span class="block text-3xl font-extrabold text-base-content">{{ plan.priceMonthly }} <span class="text-lg font-medium text-base-content/60">zł</span></span>
                        <span class="text-xs uppercase font-bold tracking-wide text-base-content/40">miesięcznie</span>
                    </div>
                </div>

                <div class="stats stats-horizontal w-full bg-base-200/50 shadow-inner mb-6 border border-base-200 rounded-lg">
                    <div class="stat px-2 py-3 place-items-center">
                        <div class="stat-title text-[10px] uppercase font-bold tracking-wider">Prac.</div>
                        <div class="stat-value text-lg">{{ plan.maxEmployees }}</div>
                    </div>
                    <div class="stat px-2 py-3 place-items-center border-l border-base-300">
                        <div class="stat-title text-[10px] uppercase font-bold tracking-wider">Usług</div>
                        <div class="stat-value text-lg">{{ plan.maxServices }}</div>
                    </div>
                    <div class="stat px-2 py-3 place-items-center border-l border-base-300">
                        <div class="stat-title text-[10px] uppercase font-bold tracking-wider">Prowizja</div>
                        <div class="stat-value text-lg text-primary">{{ plan.commissionPercentage }}%</div>
                    </div>
                </div>

                <div class="space-y-3 mb-6">
                    <div class="flex items-center gap-3 text-sm">
                        <div class="w-6 h-6 rounded-full flex items-center justify-center shrink-0" 
                             [ngClass]="plan.hasAdvancedReports ? 'bg-success/10 text-success' : 'bg-base-200 text-base-content/30'">
                            <svg *ngIf="plan.hasAdvancedReports" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-3.5 h-3.5"><path fill-rule="evenodd" d="M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z" clip-rule="evenodd" /></svg>
                            <svg *ngIf="!plan.hasAdvancedReports" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-3.5 h-3.5"><path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z" /></svg>
                        </div>
                        <span [class.text-base-content]="!plan.hasAdvancedReports" class="font-medium">Zaawansowane Raporty</span>
                    </div>
                    <div class="flex items-center gap-3 text-sm">
                        <div class="w-6 h-6 rounded-full flex items-center justify-center shrink-0" 
                             [ngClass]="plan.hasMarketingTools ? 'bg-success/10 text-success' : 'bg-base-200 text-base-content/30'">
                            <svg *ngIf="plan.hasMarketingTools" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-3.5 h-3.5"><path fill-rule="evenodd" d="M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z" clip-rule="evenodd" /></svg>
                            <svg *ngIf="!plan.hasMarketingTools" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-3.5 h-3.5"><path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z" /></svg>
                        </div>
                        <span [class.text-base-content]="!plan.hasMarketingTools" class="font-medium">Marketing</span>
                    </div>
                </div>

                <div class="card-actions justify-between mt-auto pt-4 border-t border-base-200">
                    <button (click)="editPlan(plan)" class="btn btn-sm btn-ghost gap-2 text-primary hover:bg-primary/10">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10" /></svg>
                        Edytuj
                    </button>

                    <button *ngIf="plan.isActive" (click)="deletePlan(plan)" class="btn btn-sm btn-ghost gap-2 text-error hover:bg-error/10">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0" /></svg>
                        Usuń
                    </button>

                    <button *ngIf="!plan.isActive" (click)="activatePlan(plan)" class="btn btn-sm btn-ghost gap-2 text-success hover:bg-success/10">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                        Aktywuj
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>